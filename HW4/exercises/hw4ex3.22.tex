% chktex-file 3 chktex-file 12 chktex-file 18 chktex-file 36 chktex-file 40
\section*{Exercise 3.22.}

If $X_t = Z_t - \theta Z_{t-1}$, $\{Z_t\} \sim \text{WN}(0, \sigma^2)$ and $|\theta| < 1$, show from the prediction equations that the best linear predictor of $X_{n+1}$ in $\overline{\text{sp}}\{X_1, \dots, X_n\}$ is
\[ \hat{X}_{n+1} = \sum_{j=1}^{n} \phi_j X_{n+1-j}, \]
where $\phi_1, \dots, \phi_n$ satisfy the difference equations,
\[ -\theta \phi_{j-1} + (1 + \theta^2) \phi_j - \theta \phi_{j+1} = 0, \quad 2 \leq j \leq n-1, \]
with boundary conditions,
\[ (1 + \theta^2) \phi_n - \theta \phi_{n-1} = 0 \]
and
\[ (1 + \theta^2) \phi_1 - \theta \phi_2 = -\theta. \]

\subsection*{Solution}

The prediction equations state that
\[ \angles{X_{n+1}-\sum_{j=1}^{n}\phi_{j}X_{n+1-j},X_{k}}=0,\qquad k=n,n-1,\ldots,1. \]
Equivalently, we know that if $\{X_t\}$ is a stationary process with autocovariance function $\gamma(\cdot)$, then $\phi = (\phi_1,\ldots, \phi_n)^T$ is the solution for the equation
\[ \Gamma_n \phi = \gamma_n, \]
where $\gamma_{n}=(\gamma(1),\ldots,\gamma(n))^{T}$ and $\Gamma_{n}=[\gamma(i-j)]_{i,\, j=1}^{n}$. Note that
\[ \everymath{\displaystyle}
\arraycolsep=1.8pt\def\arraystretch{1.5}
\begin{array}{rcl}
    \gamma(0) & = & \E[X_0 X_0]\\
    & = & \E[Z_0 Z_0] - \theta \E[Z_0 Z_{-1}] - \theta \E[Z_{-1} Z_{0}] + \theta^2 \E[Z_{-1} Z_{-1}]\\
    & = & \sigma^2(1 + \theta^2). 
\end{array} \]
\[ \everymath{\displaystyle}
\arraycolsep=1.8pt\def\arraystretch{1.5}
\begin{array}{rcl}
    \gamma(-1) = \gamma(1) & = & \E[X_1 X_0]\\
    & = & \E[Z_1 Z_0] - \theta \E[Z_1 Z_{-1}] - \theta \E[Z_{0} Z_{0}] + \theta^2 \E[Z_{0} Z_{-1}]\\
    & = & -\sigma^2 \theta. 
\end{array}. \]

Then, for $a = (1 + \theta^2)$ and $b = -\theta$, we have the following system:
\[ \sigma^2 \left[  \begin{matrix}
    a & b & 0 & \cdots & 0\\
    b & a & b & \cdots & 0\\
    0 & b & a & \cdots & 0\\
    \vdots & \vdots & \vdots & \ddots & \vdots\\
    0 & 0 & 0 & \cdots & a 
\end{matrix} \right] 
\left[ \begin{matrix}
    \phi_1 \\ \phi_2 \\ \phi_3 \\ \vdots \\ \phi_n
\end{matrix} \right]
 = 
 \sigma^2 \left[ \begin{matrix}
    b \\ 0 \\ 0 \\ \vdots \\ 0
\end{matrix} \right]
\]
The first line of this system says
\[ (1+\theta^2) \phi_1 -\theta \phi_2 = a \phi_1 + b\phi_2 = b = -\theta. \]
From the $2$nd to $(n-1)$-th line we have 
\[ -\theta \phi_{j-1} + (1 + \theta^2) \phi_j - \theta \phi_{j+1} = b \phi_{j-1} + a \phi_j -+ b\phi_{j+1} = 0.\]
Finally, the $n$-th line gives us
\[ (1+\theta^2) \phi_{n} -\theta \phi_{n-1} = a \phi_n + b\phi_{n-1} = 0. \]